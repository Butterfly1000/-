★背景：
innodb存储引擎是聚集索引，也就是数据和索引是合并在一个文件里面的，以.ibd结尾。今天查看了一下该文件，发现并没有以.ibd结尾的文件。
是为什么呢？因为开启了共享表空间。那么下面就学习一下，共享表空间和独立表空间。

★简介
Innodb存储引擎可将所有数据存放于ibdata*文件的共享表空间，也可将每张表存放于独立的.ibd文件的独立表空间。
共享表空间以及独立表空间都是针对"数据的存储"方式而言的。
共享表空间:  某一个数据库的所有的表数据，索引文件全部放在一个文件中，默认这个共享表空间的文件路径在data目录下。 默认的文件名为:ibdata1  初始化为10M。
独立表空间:  每一个表都将会生成以独立的文件方式来进行存储，每一个表都有一个.frm表描述文件，还有一个.ibd文件。 其中这个文件包括了单独一个表的数据内容以
            及索引内容，默认情况下它的存储位置也是在表的位置之中。
            
★二者优缺点
共享表空间：
优点：
可以将表空间分成多个文件存放到各个磁盘上（表空间文件大小不受表大小的限制，如一个表可以分布在不同的文件上）。数据和文件放在一起方便管理。
缺点：
所有的数据和索引存放到一个文件中，虽然可以把一个大文件分成多个小文件，但是多个表及索引在表空间中混合存储，这样对于一个表做了大量删除操作
后表空间中将会有大量的空隙，特别是对于统计分析，日值系统这类应用最不适合用共享表空间。

独立表空间：
在配置文件（my.cnf）中设置： innodb_file_per_table
优点：
1.每个表都有自已独立的表空间。
2.每个表的数据和索引都会存在自已的表空间中。
3.可以实现单表在不同的数据库中移动。
4.空间可以回收（除drop table操作处，表空不能自已回收）
  a.Drop table操作自动回收表空间，如果对于统计分析或是日值表，删除大量数据后可以通过:alter table TableName engine=innodb;回缩不用的空间。
  b.对于使innodb-plugin的Innodb使用turncate table也会使空间收缩。
  c.对于使用独立表空间的表，不管怎么删除，表空间的碎片不会太严重的影响性能，而且还有机会处理。
缺点：
单表增加过大，如超过100个G。相比较之下，使用共享表空间的效率以及性能会更高一点。

★独立表空间参数innodb_file_per_table详解
该参数在mysql5.6.6及其后续版本默认开启，开启该参数的时候，Innodb将每个新创建的表的数据及索引存储在一个独立的.ibd文件里，而不是系统的表空间。
当这些innodb表被删除或清空的时候，存储空间会被回收。

开启innodb_file_per_table，在ALTER TABLE操作重建表的情况下，会将innodb表从系统共享表空间移动到独立的.ibd文件。

不开启innodb_file_per_table，innodb会将所有表及索引的数据存储在构成系统表空间的ibdata文件。这样会降低文件系统操作的性能开销，例如DROP TABLE 或
TRUNCATE TABLE。它最适合于将整合磁盘都用于存储mysql数据的情况，因为系统表空间不会收缩，所有的数据库都在一个空间实例里面。
当innodb_file_per_table=OFF的时候，应避免在空间受限的系统表空间里导入大量临时数据。innodb_file_per_table 可通过SET GLOBAL动态的修改为ON或OFF，
也可以在my.cnf中做永久性修改，在my.cnf中修改后生效的话需要重启mysqld服务。

mysql> set global innodb_file_per_table =ON;
mysql> show variables like '%per_table%';
+-----------------------+-------+
| Variable_name         | Value |
+-----------------------+-------+
| innodb_file_per_table | ON    |
+-----------------------+-------+
注：动态修改后仅对后续操作生效，如原来为共享表空间，动态修改为独立表空间后仅新建的表为独立表空间。

★innodb共享表空间转化为独立表空间
查看当前表空间情况:
mysql> show variables like '%per_table';
+-----------------------+-------+
| Variable_name         | Value |
+-----------------------+-------+
| innodb_file_per_table | OFF   |
+-----------------------+-------+
表示当前是共享表空间。
想要将共享表空间转化为独立表空间有两种方法：
1.先逻辑备份，然后修改配置文件my.cnf中的参数innodb_file_per_table参数为1，重启服务后将逻辑备份导入即可。
2.修改配置文件my.cnf中的参数innodb_file_per_table参数为1，重启服务后将需要修改的所有innodb表都执行一遍：alter table table_name engine=innodb;
使用第二种方式修改后，原来库中的表中的数据会继续存放于ibdata1中，新建的表才会使用独立表空间。
            
————————————————
原文链接：https://blog.csdn.net/jesseyoung/java/article/details/42236615
